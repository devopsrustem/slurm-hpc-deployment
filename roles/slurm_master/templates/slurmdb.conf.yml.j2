#
# Slurm Database Daemon Configuration
# Generated by Ansible for {{ inventory_hostname }}
# Date: {{ ansible_date_time.iso8601 }}
#

# Authentication
AuthType={{ slurmdbd_options.auth_type }}
{% if slurmdbd_options.auth_alt_types is defined and slurmdbd_options.auth_alt_types %}
AuthAltTypes={{ slurmdbd_options.auth_alt_types }}
{% endif %}

# User and Group
SlurmUser={{ slurmdbd_options.slurm_user }}

# Storage Configuration
StorageType={{ slurmdbd_options.storage_type }}
StorageHost={{ slurmdbd_options.storage_host }}
StoragePort={{ slurmdbd_options.storage_port }}
StorageUser={{ slurmdbd_options.storage_user }}
StoragePass={{ slurmdbd_options.storage_pass }}
StorageLoc={{ slurmdbd_options.storage_loc }}

# Logging
DebugLevel={{ slurmdbd_options.debug_level }}
LogFile={{ slurmdbd_options.log_file }}
SyslogFacility=daemon

# Process Management
PidFile={{ slurmdbd_options.pid_file }}

# Performance Tuning
CommitDelay={{ slurmdbd_options.commit_delay }}

# Data Retention Policies
{% if slurmdbd_options.purge_event_after is defined %}
PurgeEventAfter={{ slurmdbd_options.purge_event_after }}
{% endif %}
{% if slurmdbd_options.purge_job_after is defined %}
PurgeJobAfter={{ slurmdbd_options.purge_job_after }}
{% endif %}
{% if slurmdbd_options.purge_step_after is defined %}
PurgeStepAfter={{ slurmdbd_options.purge_step_after }}
{% endif %}
{% if slurmdbd_options.purge_suspend_after is defined %}
PurgeSuspendAfter={{ slurmdbd_options.purge_suspend_after }}
{% endif %}
{% if slurmdbd_options.purge_txn_after is defined %}
PurgeTxnAfter={{ slurmdbd_options.purge_txn_after }}
{% endif %}
{% if slurmdbd_options.purge_usage_after is defined %}
PurgeUsageAfter={{ slurmdbd_options.purge_usage_after }}
{% endif %}

# Archive Options
{% if slurmdbd_options.archive_events is defined %}
ArchiveEvents={{ slurmdbd_options.archive_events }}
{% endif %}
{% if slurmdbd_options.archive_jobs is defined %}
ArchiveJobs={{ slurmdbd_options.archive_jobs }}
{% endif %}
{% if slurmdbd_options.archive_steps is defined %}
ArchiveSteps={{ slurmdbd_options.archive_steps }}
{% endif %}
{% if slurmdbd_options.archive_suspend is defined %}
ArchiveSuspend={{ slurmdbd_options.archive_suspend }}
{% endif %}
{% if slurmdbd_options.archive_txn is defined %}
ArchiveTxn={{ slurmdbd_options.archive_txn }}
{% endif %}
{% if slurmdbd_options.archive_usage is defined %}
ArchiveUsage={{ slurmdbd_options.archive_usage }}
{% endif %}

# Security and Access Control
# Restrict access to slurmdbd
# Only slurmctld and authorized tools should connect

# Additional Parameters
# Uncomment and configure as needed for your environment

# For High Availability
# DbdBackupHost=backup-host

# For SSL/TLS (if configured)
# StorageParameters=SSL

# For debugging (increase DebugLevel to 5 for verbose logging)
# DebugLevel=5

# Accounting storage parameters
# AccountingStorageEnforce can be set in slurm.conf